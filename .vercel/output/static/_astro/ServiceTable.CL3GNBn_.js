import{j as e,L as R,B as m}from"./Loading.Dw76dUgN.js";import{r}from"./index.24z1lnX0.js";import{u as z,S as O,s as y,f as U}from"./strapi.99PukOo3.js";import{M as E,R as u,S as M}from"./index.D7nEWG0E.js";import{F as x,R as G}from"./index.CnNGgP6X.js";import{I as J,R as V}from"./Form.D2qAwbVm.js";import{U as _}from"./index.hBl1Gx-m.js";import"./index.D82GmqbV.js";import"./clsx.B-dksMZM.js";import"./index.DTLz-HeY.js";z(M)`
  &.ant-switch-checked {
    background-color: #ff0000; // Change this to your desired color
  }

  &.ant-switch-checked:hover:not(.ant-switch-disabled) {
    background-color: #ff0000; // Change this to your desired color
  }
`;const re=({servicesData:w,strapiUrl:h,strapiToken:p})=>{const[v,k]=r.useState(null),[c,f]=r.useState(!0),[n,j]=r.useState([]),[S,o]=r.useState(!1),[l,d]=r.useState(0),[s,I]=r.useState(null),[F,g]=r.useState(null),[C,$]=r.useState(""),[q,b]=r.useState(!1);r.useEffect(()=>{const a=new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});g(w),k(a)},[]);const A={onRemove:t=>{const a=n.indexOf(t),i=n.slice();i.splice(a,1),j(i)},beforeUpload:t=>(j([...n,t]),!1),fileList:n},D=t=>{I(t)},T=()=>{d(0),b(!1),f(!0)},B=t=>(console.log("Upload event:",t),Array.isArray(t)?t:t?.fileList),N=async()=>{const a=await U({endpoint:"service-orders",query:{populate:{user:{populate:"*"},personalInformation:{populate:"*"},requestInformation:{populate:"*"}}},apiUrl:h,apiToken:p});g(a),console.log(a,"datadatadatadata")},L=async t=>{if(o(!0),$(t?.message),c){const a=new FormData;a.append("files",n[0]);try{const i=await fetch(`${h}/api/upload`,{method:"POST",body:a});if(i.ok){y.success(`${n[0].name} file uploaded successfully`);const P={attachedFile:await i.json(),confirmation:c,message:t.message};await fetch(`${h}/api/service-orders/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({data:P})}),await N(),d(2),o(!1)}else y.error(`${n[0].name} file upload failed.`),o(!1)}catch(i){console.error(i),o(!1)}}else{const a={confirmation:c,message:t.message};try{await fetch(`${h}/api/service-orders/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({data:a})}),await N(),d(2),o(!1)}catch(i){console.error(i),o(!1)}}};return e.jsxs(e.Fragment,{children:[S&&e.jsx(R,{}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Service ID"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Service Name"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Date & Time"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Username"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Applicant Category"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white",children:"Status"}),e.jsx("th",{scope:"col",className:"p-4 text-xs font-medium tracking-wider text-left rtl:text-right text-gray-500 uppercase dark:text-white"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800",children:F?.sort((t,a)=>a.id-t.id)?.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"p-4 text-sm font-normal text-gray-900 whitespace-nowrap dark:text-white",children:e.jsx("span",{className:"font-semibold",children:t?.attributes?.serviceID})}),e.jsx("td",{className:"p-4 text-sm font-normal text-gray-500 whitespace-nowrap dark:text-gray-400",children:t?.attributes?.serviceName}),e.jsx("td",{className:"p-4 text-sm font-normal text-gray-500 whitespace-nowrap dark:text-gray-400",children:t?.attributes?.createdAt.slice(0,10)}),e.jsx("td",{className:"p-4 text-sm font-semibold text-gray-900 whitespace-nowrap dark:text-white",children:t?.attributes?.user?.data?.attributes?.username}),e.jsx("td",{className:"p-4 text-sm font-normal text-gray-500 whitespace-nowrap dark:text-gray-400",children:t?.attributes?.requestInformation?.applicantCategory}),e.jsx("td",{className:"p-4 whitespace-nowrap",children:t?.attributes?.confirmation?e.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-medium mr-2 rtl:mr-0 rtl:ml-2 px-2.5 py-0.5 rounded-md dark:bg-gray-700 dark:text-green-400 border border-green-100 dark:border-green-500",children:"Completed"}):e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs font-medium mr-2 rtl:mr-0 rtl:ml-2 px-2.5 py-0.5 rounded-md border border-purple-100 dark:bg-gray-700 dark:border-purple-500 dark:text-purple-400",children:"In progress"})}),e.jsx("td",{children:e.jsx(m,{className:"bg-red-500 border-red-500 text-white",onClick:()=>{b(!0),D(t)},children:"Edit"})})]},a))})]}),e.jsx(E,{centered:!0,open:q,onCancel:()=>{T()},width:500,footer:null,children:e.jsxs("div",{className:`text-center ${l===2?"py-10":"py-5"}`,children:[l!==2&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"font-bold text-3xl text-center mb-7",children:s?.attributes?.serviceName}),e.jsxs("div",{className:"flex items-center justify-center mb-10",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center  font-bold w-10 h-10  rounded-full ${l===0?"bg-primary text-white":"bg-gray-200"}`,children:"1"}),e.jsx("h4",{className:"mr-2 font-bold",children:"تقدم"})]}),e.jsxs("div",{className:"flex items-center mx-16",children:[e.jsx("div",{className:`flex items-center justify-center  font-bold w-10 h-10  rounded-full ${l===1?"bg-primary text-white":"bg-gray-200"}`,children:"2"}),e.jsx("h4",{className:"mr-2 font-bold",children:"الدفع"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center  font-bold w-10 h-10  rounded-full ${l===2?"bg-primary text-white":"bg-gray-200"}`,children:"3"}),e.jsx("h4",{className:"mr-2 font-bold",children:"مكتمل"})]})]})]}),l===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center grid grid-flex-row grid-cols-12 gap-4 justify-center",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"الاسم الأول"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.firstName})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"اسم العائلة"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.lastName})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"اسم الأب"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.fatherName})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"اسم جده"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.grandFatherName})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"بريد إلكتروني"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.email})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"عنوان"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.address})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"رقم الهوية"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.idNumber})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"رقم الهوية"}),e.jsx("h3",{children:s?.attributes?.personalInformation?.mobileNumber})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"فئة مقدم الطلب"}),e.jsx("h3",{children:s?.attributes?.requestInformation?.applicantCategory})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"تخصص مقدم الطلب"}),e.jsx("h3",{children:s?.attributes?.requestInformation?.specialty})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"نوع المؤهل"}),e.jsx("h3",{children:s?.attributes?.requestInformation?.qualificationType})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"مؤهل"}),e.jsx("h3",{children:s?.attributes?.requestInformation?.qualificationDesc})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("h4",{className:"font-bold",children:"الحالة المهنية لمقدم الطلب"}),e.jsx("h3",{children:s?.attributes?.requestInformation?.professionalStatus})]})]}),e.jsx("div",{className:"mt-10 text-center",children:e.jsx(m,{size:"large",type:"primary",onClick:()=>{d(1)},children:"ابدأ العمل على الخدمة"})})]}),l===1&&e.jsx(e.Fragment,{children:e.jsxs(x,{name:"validate_other",onFinish:L,initialValues:{"input-number":3,"checkbox-group":["A","B"]},children:[e.jsx(x.Item,{name:"confirmation",rules:[{required:!0,message:"Please pick an item!"}],children:e.jsxs(u.Group,{value:c,onChange:t=>f(t.target.value),children:[e.jsx(u.Button,{value:!0,children:"يقبل"}),e.jsx(u.Button,{value:!1,children:"رفض"})]})}),e.jsx(x.Item,{name:"message",rules:[{required:!0}],children:e.jsx(J.TextArea,{rows:6,placeholder:"اكتب رسالتك هنا"})}),c&&e.jsx(x.Item,{name:"upload",valuePropName:"fileList",getValueFromEvent:B,rules:[{required:!0}],children:e.jsx(_,{...A,children:e.jsx(m,{className:"underline bg-white text-black hover:bg-white hover:text-primary",children:"تحميل ملف PDF"})})}),e.jsx(x.Item,{style:{marginBottom:0},wrapperCol:{span:12,offset:6},children:e.jsxs(O,{style:{marginTop:30},children:[e.jsx(m,{size:"large",type:"primary",htmlType:"submit",children:"يُقدِّم"}),e.jsx(m,{size:"large",htmlType:"reset",onClick:()=>d(0),children:"خلف"})]})})]})}),l===2&&e.jsxs("div",{children:[c?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mb-3",style:{color:"hsl(var(--primary))",fontSize:76}}),e.jsx("p",{className:"text-primary font-bold text-4xl mb-3",children:"قبلت"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mb-3",style:{color:"red",fontSize:76}}),e.jsx("p",{className:"text-red-500 font-bold text-4xl mb-3",children:"رفض"})]}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:s.serviceName}),e.jsx("h3",{className:"font-semibold mb-3",children:s.serviceID}),e.jsx("p",{className:"mb-6",children:C}),e.jsxs("div",{className:"max-w-[240px] mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-base font-semibold",children:"اسم الموظف:"}),e.jsx("h4",{className:"text-base",children:"Adam"})]}),e.jsxs("div",{className:"flex items-center justify-between mx-4",children:[e.jsx("h4",{className:"text-base font-medium",children:"تاريخ بدء الخدمة:"}),e.jsx("h4",{className:"text-base",children:v})]})]})]})]})})]})};export{re as default};
