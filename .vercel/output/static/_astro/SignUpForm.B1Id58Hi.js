import{j as e,L as g,B as x}from"./Loading.Dw76dUgN.js";import{F as s,I as a}from"./Form.D2qAwbVm.js";import{r as j}from"./index.24z1lnX0.js";import{B as l}from"./_astro-entry_react-toastify.CDZtbDrs.js";import"./index.D82GmqbV.js";import"./clsx.B-dksMZM.js";const C=({apiUrl:m,apiToken:u})=>{const[c,i]=j.useState(!1),d=async r=>{i(!0);const n=r.fullName,t=r.email,p=r.password,h={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`bearer ${u}`},body:JSON.stringify({username:n,email:t,password:p,isEmployee:!0})},f=`${m}/api/auth/local/register`,o=await(await fetch(f,h)).json();if(o.error){console.log(o.error.message,!0),console.error("❗️Error with the Response"+o.error),setTimeout(()=>{i(!1)},1500),l.warn("Email or Username already exit!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"});return}o.jwt&&o.user&&(console.log("Successfull registration"),setTimeout(()=>{i(!1)},1500),l.success("👌 Successfull registration!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),setTimeout(()=>{location.href="/signin"},1500))};return e.jsxs(e.Fragment,{children:[c&&e.jsx(g,{}),e.jsx("div",{className:"max-w-[500px] w-full mx-auto min-h-screen flex items-center justify-center",children:e.jsxs(s,{className:"border p-10 rounded-xl shadow-2xl w-full",name:"basic",layout:"vertical",autoComplete:"off",onFinish:d,children:[e.jsx("h3",{className:"text-3xl font-bold mb-6",children:"Register a new user"}),e.jsx(s.Item,{label:"Full Name",name:"fullName",rules:[{required:!0,message:"Please input your username!"}],children:e.jsx(a,{})}),e.jsx(s.Item,{label:"Email",name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your email!"}],children:e.jsx(a,{})}),e.jsx(s.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"},{required:!0,message:"Please input more than 6 characters",min:6}],children:e.jsx(a.Password,{})}),e.jsx(s.Item,{label:"Confirm Password",name:"confirmPassword",dependencies:["password"],rules:[{required:!0},({getFieldValue:r})=>({validator(n,t){return!t||r("password")===t?Promise.resolve():Promise.reject(new Error("The new password that you entered do not match!"))}})],children:e.jsx(a.Password,{})}),e.jsxs("div",{className:"mb-5",children:["Already have an account?"," ",e.jsx("a",{href:"/signin",className:"font-semibold text-primary",children:"Login"})]}),e.jsx(s.Item,{className:"mb-0",children:e.jsx(x,{type:"primary",htmlType:"submit",children:"Create account"})})]})})]})};export{C as default};
